<html>
<head>
    <meta charset="utf-8" />
<meta name="description" content="" />
<meta name="viewport" content="width=device-width, initial-scale=1" />

<title>ReactNative学习 | Sanri&#39;s Blog</title>

<link rel="shortcut icon" href="http://localhost:4000/favicon.ico?v=1645605853221">

<link href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" rel="stylesheet">
<link rel="stylesheet" href="http://localhost:4000/styles/main.css">
<!-- <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.0/dist/css/bootstrap.min.css"> -->

<script src="https://cdn.jsdelivr.net/npm/@highlightjs/cdn-assets/highlight.min.js"></script>
<script src="https://cdn.bootcdn.net/ajax/libs/highlight.js/9.12.0/languages/dockerfile.min.js"></script>
<script src="https://cdn.bootcdn.net/ajax/libs/highlight.js/9.12.0/languages//dart.min.js"></script>

<!-- <script src="https://cdn.jsdelivr.net/npm/moment@2.27.0/moment.min.js"></script> -->
<!-- <script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js"></script> -->
<!-- <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"></script> -->
<!-- <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.0/dist/js/bootstrap.min.js"></script> -->
<!-- DEMO JS -->
<!--<script src="media/scripts/index.js"></script>-->



    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.css">
</head>
<body>
<div class="main gt-bg-theme-color-first">
    <nav class="navbar navbar-expand-lg">
    <a class="navbar-brand" href="/">
        <img class="user-avatar" src="/images/avatar.png" alt="头像">
        <div class="site-name gt-c-content-color-first">
            Sanri&#39;s Blog
        </div>
    </a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent"
        aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation" id="changeNavbar">
        <i class="fas fa-bars gt-c-content-color-first" style="font-size: 18px"></i>
    </button>
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <div class="navbar-nav mr-auto" style="text-align: center">
            
            <div class="nav-item">
                
                <a href="/" class="menu gt-a-link">
                    首页
                </a>
                
            </div>
            
        </div>
        <div style="text-align: center">
            <form id="gridea-search-form" style="position: relative" data-update="1645605853221"
                action="/search/">
                <input class="search-input" autocomplete="off" spellcheck="false" name="q" placeholder="搜索文章" />
                <i class="fas fa-search gt-c-content-color-first" style="position: absolute; top: 9px; left: 10px;"></i>
            </form>
        </div>
    </div>
</nav>
<script>
    /* 移动端导航栏展开/收起切换 */
    document.getElementById('changeNavbar').onclick = () => {
        var element = document.getElementById('navbarSupportedContent');
        if (element.style.display === 'none' || element.style.display === '') {
            element.style.display = 'block';
        } else {
            element.style.display = 'none';
        }
    }
</script>

    <div class="post-container">
        <div class="post-detail gt-bg-theme-color-second">
            <article class="gt-post-content">
                <h2 class="post-title">
                    ReactNative学习
                </h2>
                <div class="post-info">
                    <time class="post-time gt-c-content-color-first">
                        · 2020-08-12 ·
                    </time>
                    
                </div>
                <div class="post-content">
                    <h1 id="react-naitve-指令">React Naitve 指令</h1>
<pre><code>react-native init MyApp --version 0.44.3

npm install 安装module 

react-native run-ios --simulator 'iPhone 8'

npm start 开启服务

npm update -g react-native-cli 更新react-native环境

npm install --save react-native@0.44.3 安装指定版本的react native

react-native upgrade 更新项目文件

npm install realm 安装对应的库

react-native link 链接对应的库

npm uninstall react-native-video 删除对应的库文件
</code></pre>
<h1 id="reactredux">ReactRedux</h1>
<p>Dispatch Action -&gt; reducer处理state-&gt; Provider接收到变化的State-&gt;setState（dummyState）-&gt;connect的组件触发componentWillReceiveProps-&gt;进行props判断，如果判断有变化-&gt;更新子组件props-&gt;触发子组件的Render。</p>
<h1 id="flatlist遇到的问题">FlatList遇到的问题</h1>
<p>上拉加载会触发 onEndReached</p>
<p>FlatList触发onEndReached的时机是：<br>
1._onContentSizeChange<br>
2._onScroll<br>
3._onLayout</p>
<p>现象是上拉加载会触发两次onEndReached<br>
排除了1，3，因此是上拉加载时触发了两次_onScroll<br>
（_onScroll时ScrollView的回调函数，只要滑动则调用。）</p>
<p>onEndReached被包了一层（_maybeCallOnEndReached），因此从源码看出是有条件的被触发<br>
<img src="http://localhost:4000/post-images/1597209975417.png" alt="" loading="lazy"></p>
<p>现在解释上拉加载触发两次onEndReached的原因：<br>
上拉加载----&gt;触发_onScroll----&gt;满足条件----&gt;触发onEndReached（在此时页面仍然是被滑动的，因此仍然会触发_onScroll）----&gt;同时又满足条件----&gt;又触发了onEndReacher</p>
<p>再解释一下，代码如下时上拉加载会触发一次onEndReached的原因<br>
<img src="http://localhost:4000/post-images/1597209981314.png" alt="" loading="lazy"></p>
<p>上拉加载----&gt;触发_onScroll----&gt;满足条件----&gt;触发onEndReached（在此时页面仍然是被滑动的，因此仍然会触发_onScroll）----&gt;而此时条件是不被满足的，因此不会触发onEndReacher</p>
<p>那满足的onEndReacher的条件是什么？<br>
<img src="http://localhost:4000/post-images/1597209986897.png" alt="" loading="lazy"></p>
<p>经过调试发现，this._hasDataChangedSinceEndReached是导致两次现象不同的变量。<br>
<img src="http://localhost:4000/post-images/1597209992416.png" alt="" loading="lazy"></p>
<p>可以看到这个变量在componentWillReceiveProps的时候被赋值，因此是在网络请求后，FlatList的datesource会被改变，因此可以满足触发onEndReacher的条件，而触发一次onEndReacher的原因是，在网络请求后，数据没有被更新，这个变量为false，因此不满足条件。</p>
<p>解决方案：</p>
<p>现在目前的触发场景：上拉加载----&gt;触发_onScroll----&gt;满足条件----&gt;触发onEndReached（在此时页面仍然是被滑动的，因此仍然会触发_onScroll）----&gt;同时又满足条件----&gt;又触发了onEndReacher，因此只要切段第二次的满足条件，即可。原理就是加状态位控制。</p>
<h1 id="reactnative-颜色写法">ReactNative 颜色写法</h1>
<p>以下这些格式的颜色代码都是支持的：</p>
<ul>
<li>'#f0f' (#rgb)</li>
<li>'#f0fc' (#rgba)</li>
<li>'#ff00ff' (#rrggbb)</li>
<li>'#ff00ff00' (#rrggbbaa)</li>
<li>'rgb(255, 255, 255)'</li>
<li>'rgba(255, 255, 255, 1.0)'</li>
<li>'hsl(360, 100%, 100%)'</li>
<li>'hsla(360, 100%, 100%, 1.0)'</li>
<li>'transparent'</li>
<li>'red'</li>
<li>0xff00ff00 (0xrrggbbaa)</li>
</ul>
<h1 id="flux-redux">Flux &amp;&amp; Redux</h1>
<p><img src="http://localhost:4000/post-images/1597210000932.png" alt="" loading="lazy"><br>
Store 就是保存数据的地方，你可以把它看成一个容器。整个应用只能有一个 Store。</p>
<p><img src="http://localhost:4000/post-images/1597210005698.png" alt="" loading="lazy"><br>
Redux 规定， 一个 State 对应一个 View。只要 State 相同，View 就相同。你知道 State，就知道 View 是什么样，反之亦然。<br>
Action 描述当前发生的事情。改变 State 的唯一办法，就是使用 Action。它会运送数据到 Store。<br>
store.dispatch()是 View 发出 Action 的唯一方法<br>
Store 收到 Action 以后，必须给出一个新的 State，这样 View 才会发生变化。这种 State 的计算过程就叫做 Reducer。</p>

                </div>
            </article>
        </div>

        
            <div class="next-post">
                <div class="next gt-c-content-color-first">下一篇</div>
                <a href="http://localhost:4000/post/python-xue-xi/" class="post-title gt-a-link">
                    Python学习
                </a>
            </div>
        

        

        

        

        <div class="site-footer gt-c-content-color-first">
    <div class="slogan gt-c-content-color-first"></div>
    <div class="social-container">
        
            
        
            
        
            
        
            
        
            
        
            
        
    </div>
    <div class="footer-info">
        
    </div>
    <!-- <div>
        Theme by <a href="https://imhanjie.com/" target="_blank">imhanjie</a>, Powered by <a
                href="https://github.com/getgridea/gridea" target="_blank">Gridea | <a href="http://localhost:4000/atom.xml" target="_blank">RSS</a></a>
    </div> -->
</div>

<script>
  hljs.highlightAll()
</script>

    </div>
</div>
</body>
</html>
